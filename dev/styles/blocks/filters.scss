/**
 * You can find markup and macro in `components/filters/filters.njk`
 *
 * Use macro: `{{ filters() }}`
 *
 * @section Filters macro
 * @page Filters
 */

/**
 * @section Filters one column
 * @page Filters
 *
 * @example
 * <div class="filters">
 *      <div class="container filters__container">
 *          <div class="filters__dropdown">
 *              <form action="#" method="get">
 *                  <fieldset>
 *                      <legend>Filtrer les actualités par:</legend>
 *                      <div class="filters__wrapper -inline">
 *                          <div class="filters__fields flex-row">
 *                              <div class="filters__field col-xs-12">
 *                                  <label for="select">Select label</label>
 *                                  <select name="select" id="select">
 *                                      <option value="0">- Sélectionner -</option>
 *                                      <option value="1">Option 1</option>
 *                                      <option value="2">Option 2</option>
 *                                  </select>
 *                              </div>
 *                          </div>
 *                          <div class="filters__buttons">
 *                               <button type="reset" class="btn filters__button -reset" data-fa-icon="&#xf00d;">Effacer</button>
 *                               <button type="submit" class="btn filters__button -submit" data-fa-icon="&#xf0b0;">Filtrer</button>
 *                          </div>
 *                      </div>
 *                  </fieldset>
 *              </form>
 *          </div>
 *      </div>
 * </div>
 *
 */

/**
 * @section Filters two columns
 * @page Filters
 *
 * @example
 * <div class="filters">
 *      <div class="container filters__container">
 *          <div class="filters__dropdown">
 *              <form action="#" method="get">
 *                  <fieldset>
 *                      <legend>Filtrer les actualités par:</legend>
 *                      <div class="filters__wrapper">
 *                          <div class="filters__fields flex-row">
 *                              <div class="filters__field col-xs-6">
 *                                  <label for="keyword">Input label</label>
 *                                  <input type="text" name="keyword" id="keyword" value="" placeholder="Placeholder hint...">
 *                              </div>
 *                              <div class="filters__field col-xs-6">
 *                                  <label for="select2">Select label</label>
 *                                  <select name="select2" id="select2">
 *                                      <option value="0">- Sélectionner -</option>
 *                                      <option value="1">Option 1</option>
 *                                      <option value="2">Option 2</option>
 *                                  </select>
 *                              </div>
 *                              <div class="filters__field col-xs-6">
 *                                  <label for="keyword2">Input label</label>
 *                                  <input type="text" name="keyword2" id="keyword2" value="" placeholder="Placeholder hint...">
 *                              </div>
 *                          </div>
 *                          <div class="filters__buttons">
 *                               <button type="reset" class="btn filters__button -reset" data-fa-icon="&#xf00d;">Effacer</button>
 *                               <button type="submit" class="btn filters__button -submit" data-fa-icon="&#xf0b0;">Filtrer</button>
 *                          </div>
 *                      </div>
 *                  </fieldset>
 *              </form>
 *          </div>
 *      </div>
 * </div>
 *
 */

/**
 * @section Filters three columns
 * @page Filters
 *
 * @example
 * <div class="filters">
 *      <div class="container filters__container">
 *          <div class="filters__dropdown">
 *              <form action="#" method="get">
 *                  <fieldset>
 *                      <legend>Filtrer les actualités par:</legend>
 *                      <div class="filters__wrapper">
 *                          <div class="filters__fields flex-row">
 *                              <div class="filters__field col-xs-4">
 *                                  <label for="select3">Select label</label>
 *                                  <select name="select3" id="select3">
 *                                      <option value="0">- Sélectionner -</option>
 *                                      <option value="1">Option 1</option>
 *                                      <option value="2">Option 2</option>
 *                                  </select>
 *                              </div>
 *                              <div class="filters__field col-xs-4">
 *                                  <label for="select4">Select label</label>
 *                                  <select name="select4" id="select4">
 *                                      <option value="0">- Sélectionner -</option>
 *                                      <option value="1">Option 1</option>
 *                                      <option value="2">Option 2</option>
 *                                  </select>
 *                              </div>
 *                              <div class="filters__field col-xs-4">
 *                                  <label for="keyword3">Input label</label>
 *                                  <input type="text" name="keyword3" id="keyword3" value="" placeholder="Placeholder hint...">
 *                              </div>
 *                              <div class="filters__field col-xs-4">
 *                                  <label for="input-date">Date:</label>
 *                                  <input type="date" id="input-date" value="" class="access__title" tabindex="0" data-name="input-date" title="jj/mm/aaaa">
 *                                  <input type="hidden" name="input-date" id="input-date-hidden" value="">
 *                                  <div class="checkbox">
 *                                      <input type="checkbox" name="checkbox1_3" id="checkbox1_3" value="Cum facilis fugit harum nemo neque">
 *                                      <label for="checkbox1_3">Cum facilis fugit harum nemo neque</label>
 *                                  </div>
 *                              </div>
 *                              <div class="filters__field col-xs-4">
 *                                  <label for="select__periode">Période:</label>
 *                                  <select name="select__periode" id="select__periode">
 *                                      <option value="0">- Toutes les dates -</option>
 *                                      <option value="1">Option 1</option>
 *                                      <option value="2">Option 2</option>
 *                                  </select>
 *                              </div>
 *                          </div>
 *                          <div class="filters__buttons">
 *                               <button type="reset" class="btn filters__button -reset" data-fa-icon="&#xf00d;">Effacer</button>
 *                               <button type="submit" class="btn filters__button -submit" data-fa-icon="&#xf0b0;">Filtrer</button>
 *                          </div>
 *                      </div>
 *                  </fieldset>
 *              </form>
 *          </div>
 *      </div>
 * </div>
 *
 */

$filters-bg: $color-3--1;

.filters {
    $this: &;

    &__btn {
        display: none;

        @include breakpoint(small down) {
            display: block;
        }

        &.btn {
            @include icon-before(\f0b0);

            background-color: $color-1--3;
            height: 3.2rem;
            line-height: 3.2rem;
            padding: 0;
            width: 3.2rem;

            &::before {
                color: $color-white !important;
                font-size: 1.2rem;
            }

            @include on-event() {
                background-color: $color-1--2;
            }
        }

        &[aria-expanded='true'] {
            @include icon-before(\f00d);

            &.btn {
                background-color: $color-1--3;
            }
        }

        &[aria-expanded='false'] {
             &.btn {
                background-color: $color-1--3;
            }
        }
    }

    &__dropdown {
        left: 0;
        list-style: none;
        min-width: 100%;
        opacity: 1;
        padding: 0;
        top: 100%;
        transition: visibility 200ms ease-in-out, transform 350ms ease-in-out, opacity 200ms ease-in-out;
        visibility: visible;
        width: auto;
        z-index: 5;

        @include breakpoint(small down) {
            left: 1rem;
            max-height: 0;
            max-width: calc(100% - 2rem);
            min-width: inherit;
            opacity: 0;
            overflow: hidden;
            position: absolute;
            visibility: hidden;
        }

        .-is-open & {
            opacity: 1;
            transform: translateY(-1rem);
            transition: visibility 200ms ease-in-out, transform 200ms ease-in-out, opacity 350ms ease-in-out;
            visibility: visible;

            @include breakpoint(small down) {
                max-height: 75rem;
                max-width: 100%;
                overflow: visible;
                position: static;
            }
        }
    }

    .flex-row {
        margin-left: -0.5rem;
        margin-right: 0.5rem;

        @include breakpoint(small down) {
            margin: 0;
        }
    }

    [class*='col-'] {
        padding-left: 0.5rem;
        padding-right: 0.5rem;

        @include breakpoint(small down) {
            padding: 0;
        }
    }

    form {
        margin-bottom: 0;
    }

    fieldset {
        margin: 0 0 1.5rem;
        padding: 0;
    }

    input:not([type*='checkbox']):not([type*='radio']),
    select {
        height: 5rem;
    }

    input,
    textarea,
    select {
        background-color: #f0f0f0;
        color: #212851;
        font-style: normal;
    }

    input {
        &::placeholder {
            color: $color-1--3;
            font-style: normal;
        }
    }

    input[type=date] {
        appearance: none;

        &::-webkit-calendar-picker-indicator {
            color: transparent;
            background: transparent;
        }

        &::-webkit-inner-spin-button {
            appearance: none;
            display: none;
        }
    }

    .checkbox {
        &:first-child {
            margin-top: 0;
        }
    }

    &__wrapper {
        display: flex;

        @include breakpoint(small down) {
            align-items: center;
            flex-direction: column;
        }
    }

    &__fields {
        flex-grow: 1;

        @include breakpoint(medium down) {
            width: 100%;
        }
    }

    &__field {
        /*display: flex;*/
        flex-direction: column;
        margin-bottom: 2rem;
        position: relative;

        label {
            color: $color-1--3;
            flex-shrink: 0;
        }

        .-inline & {
            align-items: center;
            flex-direction: row;

            label {
                margin: 0 1.5rem 1rem 0;
            }
        }
    }

    &__buttons {
        flex-shrink: 0;
        margin-top: 2.1rem;

        @include breakpoint(small down) {
            margin-top: 0;
        }

        .-inline & {
            margin-top: 2.7rem;
        }

        &-link {
            color: $color-3--3;
            display: block;
            font-size: 1.2rem;
            font-style: italic;
            margin-top: 1rem;
            text-align: right;
            text-decoration: underline;

            @include on-event() {
                text-decoration: none;
            }
        }
    }

    &__button {
        font-size: 1.5rem;
        font-weight: $normal;
        margin-left: 1rem;
        min-height: 5rem;
        padding: 1.5rem 2.3rem;

        @include breakpoint(small down) {
            margin-left: 0;
            margin-bottom: 0.5rem;

            &:not(:last-child) {
                margin-right: 1rem;
            }
        }

        &[data-fa-icon]::before {
            font-size: 1.5rem;
            font-weight: $normal;
        }
    }

    // FILTER ON THE MAP PAGE
    &__map {
        background: $color-3--1;
        box-shadow: 3px 0 7px #d1d1d1;
        height: 100%;
        padding: 3.5rem 0 1rem;

        form,
        fieldset {
            height: 100%;
            margin-bottom: 0;
        }

        .filters__field  input {
          background: $color-white;
          color: #727272;
          font-style: italic;
        }

        legend,
        label {
          font-size: 1.4rem;
          text-transform: uppercase;
        }

        form > fieldset > legend {
            padding: 0 3rem;
            color: #ca000a;
            font-size: 1.9rem;
            padding-bottom: 10px;
            position: relative;
            &::before {
              content: '';
              position: absolute;
              bottom: 0;
              width: 6.7rem;
              height: .1rem;
              background: #ca000a;
            }
        }

        .checkbox {
          label {
            font-size: 1.4rem;
            color: #727272;
            font-style: normal;
            text-transform: none;
            &::before {
              border-color: #c5c5c5;
            }
            &::after {
              font-size: 1rem;
              transform: none !important;
              left: 3px;
              top: 4px;
            }
          }
          > li {
            > label {
              color: $color-black;
              text-transform: uppercase;
            }
          }
        }

        .map-toggle-resultats {
          display: none;
        }

          .filters__buttons {
            button {
              border-color: #dddddd;
              font-size: 1.4rem;
              color: $color-black;
              font-family: $typo-3;
              &:hover {
                color: $color-white;
              }
            }
            .-reset {
              font-weight: $light;
              &::before {
                color: #009fba;
              }
            }
            .-submit {
              font-weight: $bold;
              &::before {
                color: #ca000a;
              }
            }
          }



        #{$this}__wrapper {
            display: block;
            height: calc(100% - 7.1rem);
        }

        #{$this}__fields {
            align-content: flex-start;
            align-items: flex-start;
            flex-grow: 0;
            flex-wrap: wrap;
            justify-content: flex-start;
            margin: 0;
            width: 100%;
        }

        #{$this}__buttons {
            @include flex(row, wrap);
            margin-top: 1rem;
            padding: 0 3rem;
            width: 100%;

            button {
                width: calc(50% - 0.5rem);

                &:first-child {
                    margin-left: 0;
                }
            }
        }

        #{$this}__field {
            flex-basis: auto;
            margin-bottom: 2.8rem;
            max-width: 100%;
            padding: 0 3rem;
            width: 100%;
        }

        .-is-scroll-box {
            height: calc(100vh - 30.6rem);
            overflow-x: hidden;
            overflow-y: auto;

            @include breakpoint(small down) {
                height: calc(100vh - 29rem);
            }
        }
    }

    &__map-form {
        height: 100%;
    }

    .custom-calendar-icon {
        position: relative;

        &::after {
            content: '';
            display: block;
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            width: 50px;
            height: 50px;
            background-color: $color-1--5;
            pointer-events: none;
            z-index: 1;
            cursor: pointer;
        }

        &::before {
            content: '';
            display: block;
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            z-index: 2;
            width: 50px;
            height: 50px;
            background: {
                image: url(../images/calendar.svg);
                position: calc(100% - 0.75em) 50%;
                repeat: no-repeat;
                size: 16px;
            }
            pointer-events: none;
            cursor: pointer;
        }
    }
}
